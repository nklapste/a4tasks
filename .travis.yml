language: cpp
os: linux


matrix:
  include:
  - compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - g++5
    env: COMPILER=g++-5
  - compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - g++6
    env: COMPILER=g++-6
  - compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - g++-7
    env: COMPILER=g++-7
  - compiler: clang
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - llvm-toolchain-precise-3.6
        packages:
        - clang-3.6
    env: COMPILER=clang++-3.6
  - compiler: clang
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - llvm-toolchain-precise-3.7
        packages:
        - clang-3.7
    env: COMPILER=clang++-3.7

stages:
  - test

jobs:
  include:
  - stage: test
    name: "make"
    script:
      - make clean
      - make
      - make tar
  - name: "cmake"
    script:
      - cmake .
      - cmake --build .
  - name: "cppcheck"
    install:
      - sudo apt-get install -qq cppcheck
    script:
      - cppcheck --error-exitcode=1 .
  - name: "lint"
    language: python
    python: 3.6
    install:
      - pip3 install cpplint
    script:
      - cpplint